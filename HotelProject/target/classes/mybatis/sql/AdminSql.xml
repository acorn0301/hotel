<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="admin">
	<select id="adminTotalCount" resultType="int">
		select count(*) from hotel
	</select>

	<select id="adminGetBookListStatus0" resultType="int">
		select count(*) from book where book_status='예약대기'
	</select>

	<select id="adminGetBookListCheckIn" resultType="int">
		select count(*) from book where TO_CHAR(trunc(check_in), 'yyyy-MM-dd HH24miSS') =  TO_CHAR(trunc(SYSDATE), 'yyyy-MM-dd HH24miSS')
	</select>
	
	<select id="adminGetBookListCheckOut" resultType="int">
		select count(*) from book where TO_CHAR(trunc(check_out), 'yyyy-MM-dd HH24miSS') =  TO_CHAR(trunc(SYSDATE), 'yyyy-MM-dd HH24miSS')
	</select>
	
	<select id="adminGetBookListWaiting" resultType="int">
		select count(*) from book where book_status='예약완료'		
	</select>
	
	<select id="adminGetOrderListStatus0" resultType="int">
		select count(*) from room_order where room_status='접수'
	</select>
	
	<select id="adminGetOrderListStatus1" resultType="int">
		select count(*) from room_order where room_status='준비중'
	</select>
	
	<select id="adminGetQnaByCategory" parameterType="String" resultType="int">
		select count(*) from qna where category=#{category}
	</select>
	
	<select id="adminGetBookDetail" parameterType="bdto" resultType="spring.data.AdminBookDto">
		select
		b.book_num, b.member_num, b.check_in, b.check_out, b.head_count, b.book_memo, b.book_status, b.book_day, b.add_bed, b.breakfast_count,
		m.name, m.id,
		h.hotel_num, h.hotel_local, 
		r.room_num, r.room_name, r.type, r.price, r.room_local
		from hotel h, room r, book b, member m
		where 
		b.book_num=#{book_num} and
		b.member_num = m.member_num
		and r.room_num=#{room_num} 
		and h.hotel_num = (select r.hotel_num from room r where r.room_num=#{room_num})
	</select>
	
	<select id="adminGetBookDto" parameterType="int" resultType="bdto">
		select * from book where book_num = #{book_num}
	</select>
	
	<select id="adminGetBookListByStatus" parameterType="String" resultType="spring.data.AdminBookDto">
		select book_num, add_bed,breakfast_count, b.room_num, hotel_local, room_local, 
		head_count, check_in, check_out,
		m.name, m.id, book_day
		from book b, member m,
		(select hotel_local, room_num, room_local 
		from hotel h, room r 
		where h.hotel_num = r.hotel_num) a 
		where b.room_num = a.room_num and
		b.member_num = m.member_num and
		b.book_status=#{book_status}
		order by book_day
	</select>
	
</mapper>
