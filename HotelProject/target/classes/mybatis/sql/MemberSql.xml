<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="member">
   <!-- 회원가입(회원추가) -->
   <insert id="memberInsert" parameterType="mbdto">
      insert into member(member_num,id,password,name,birth,phone,email,joinday,grade) values (
      memberseq.nextval,#{id},#{password},#{name},#{birth},#{phone},#{email},sysdate,'c')
   </insert>

   <!-- 로그인 (id와 pw가 일치하면1 없으면0 사용자 정보 담고있는 객체 반환)-->
   <select id="login" parameterType="HashMap" resultType="int"> 
	  select count(*) from member where id=#{id} and password=#{password}
   </select>
   
	<!-- 아이디 비밀번호로 member_num 얻기 -->
	<select id="getMembernum" parameterType="HashMap" resultType="int">
		select member_num from member where id=#{id} and password=#{password}
	</select>
	
	<!-- member_num으로 회원정보 얻기 -->
	<select id="getMemberData" parameterType="int" resultType="mbdto">
		select * from member where member_num=#{member_num}
	</select>
	
	<!-- 회원 정보 수정 -->
	<update id="infoEdit" parameterType="mbdto">
 		update member set password=#{password},phone=#{phone},email=#{email} where member_num=#{member_num}
	</update>
	
	<!-- 아이디 중복체크 -->
	<select id="checkOverId" parameterType="String" resultType="int">
		select count(*) from member where id=#{id}
	</select>
	
	<!-- 비밀번호 찾기 (이메일 보내기) -->
	<select id="getPw" resultType="String" parameterType="HashMap">
		select password from member where name=#{name} and email=#{email}
	</select>
	
	<!-- 아이디 찾기 -->
	<select id="getId" parameterType="HashMap" resultType="String">
		select id from member where name=#{name} and email=#{email}
	</select>
	
	<!-- 임시 비밀번호로 변경 -->
	<update id="setPw" parameterType="mbdto">
		update member set password=#{password} where name=#{name} and email=#{email}
	</update>

</mapper>